<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
  <meta name="description" content="{{ page.description | default: site.description }}">

  <!-- Structured Data for Rich Results -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "LocalBusiness",
        "@id": "{{ site.url }}/#business",
        "name": "Bartusch - Holz und Handwerk",
        "description": "{{ site.description }}",
        "url": "{{ site.url }}",
        "telephone": "+49 7453 9569626",
        "email": "rainer@bartusch-handwerk.de",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "Benzstraße 6",
          "addressLocality": "Altensteig",
          "postalCode": "72213",
          "addressCountry": "DE"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": 48.5847,
          "longitude": 8.6044
        },
        "priceRange": "$$",
        "image": "{{ site.url }}/assets/images/workshop-1.jpg",
        "founder": {
          "@type": "Person",
          "name": "Rainer Bartusch",
          "jobTitle": "Schreinermeister"
        },
        "areaServed": {
          "@type": "GeoCircle",
          "geoMidpoint": {
            "@type": "GeoCoordinates",
            "latitude": 48.5847,
            "longitude": 8.6044
          },
          "geoRadius": "50000"
        },
        "knowsAbout": ["Holzbearbeitung", "Möbelbau", "Schreinerarbeiten", "Holztrocknung", "Holzverkauf"]
      },
      {
        "@type": "WebSite",
        "@id": "{{ site.url }}/#website",
        "url": "{{ site.url }}",
        "name": "{{ site.title }}",
        "publisher": { "@id": "{{ site.url }}/#business" }
      }
      {% if page.url != "/" %},
      {
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Startseite",
            "item": "{{ site.url }}"
          }{% if page.url contains '/leistungen/' and page.url != '/leistungen/' %},
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Leistungen",
            "item": "{{ site.url }}/leistungen/"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "{{ page.title }}",
            "item": "{{ site.url }}{{ page.url }}"
          }{% else %},
          {
            "@type": "ListItem",
            "position": 2,
            "name": "{{ page.title }}",
            "item": "{{ site.url }}{{ page.url }}"
          }{% endif %}
        ]
      }
      {% endif %}
    ]
  }
  </script>

  <link rel="icon" href="{{ '/assets/images/favicon.ico' | relative_url }}" type="image/png">
  <link rel="stylesheet" href="{{ '/assets/vendor/mdi/css/materialdesignicons.min.css' | relative_url }}">
  <link rel="stylesheet" href="{{ '/assets/vendor/glightbox/glightbox.min.css' | relative_url }}">
  <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
  <script>var t=localStorage.getItem('theme');if(t)document.documentElement.setAttribute('data-theme',t);</script>
</head>
<body>
  {% include mobile-nav.html %}
  {% include nav.html %}

  <main class="content">
    {{ content }}
  </main>

  {% include footer.html %}
  <script>
    (function() {
      var btn = document.getElementById('theme-toggle');
      if (!btn) return;
      btn.addEventListener('click', function() {
        var html = document.documentElement;
        var current = html.getAttribute('data-theme');
        var isDark = current === 'dark' ||
          (!current && window.matchMedia('(prefers-color-scheme: dark)').matches);
        var next = isDark ? 'light' : 'dark';
        html.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
      });
    })();
  </script>
  <script src="{{ '/assets/vendor/glightbox/glightbox.min.js' | relative_url }}"></script>
  <script>GLightbox({ selector: '.glightbox' });</script>
  <script>
    (function() {
      var el = document.querySelector('.map-consent');
      if (!el) return;
      var src = el.getAttribute('data-src');
      function loadMap() {
        el.outerHTML = '<iframe src="' + src + '" width="100%" height="400" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>';
      }
      if (localStorage.getItem('mapConsent')) { loadMap(); return; }
      var btn = el.querySelector('.map-consent__overlay p');
      if (btn) btn.addEventListener('click', function() {
        localStorage.setItem('mapConsent', 'true');
        loadMap();
      });
    })();
  </script>
</body>
</html>
